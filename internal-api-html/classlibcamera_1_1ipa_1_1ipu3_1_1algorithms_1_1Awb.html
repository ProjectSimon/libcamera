<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libcamera: libcamera::ipa::ipu3::algorithms::Awb Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libcamera
   &#160;<span id="projectnumber">v0.3.2+rpt20241101+6-22e19df9</span>
   </div>
   <div id="projectbrief">Supporting cameras in Linux since 2019</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacelibcamera.html">libcamera</a></li><li class="navelem"><a class="el" href="namespacelibcamera_1_1ipa.html">ipa</a></li><li class="navelem"><b>ipu3</b></li><li class="navelem"><b>algorithms</b></li><li class="navelem"><a class="el" href="classlibcamera_1_1ipa_1_1ipu3_1_1algorithms_1_1Awb.html">Awb</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classlibcamera_1_1ipa_1_1ipu3_1_1algorithms_1_1Awb-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">libcamera::ipa::ipu3::algorithms::Awb Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A Grey world white balance correction algorithm.  
 <a href="classlibcamera_1_1ipa_1_1ipu3_1_1algorithms_1_1Awb.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for libcamera::ipa::ipu3::algorithms::Awb:</div>
<div class="dyncontent">
<div class="center"><img src="classlibcamera_1_1ipa_1_1ipu3_1_1algorithms_1_1Awb__inherit__graph.png" border="0" usemap="#alibcamera_1_1ipa_1_1ipu3_1_1algorithms_1_1Awb_inherit__map" alt="Inheritance graph"/></div>
<map name="alibcamera_1_1ipa_1_1ipu3_1_1algorithms_1_1Awb_inherit__map" id="alibcamera_1_1ipa_1_1ipu3_1_1algorithms_1_1Awb_inherit__map">
<area shape="rect" title="A Grey world white balance correction algorithm." alt="" coords="5,80,156,121"/>
<area shape="rect" href="classlibcamera_1_1ipa_1_1Algorithm.html" title="The base class for all IPA algorithms." alt="" coords="37,5,124,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for libcamera::ipa::ipu3::algorithms::Awb:</div>
<div class="dyncontent">
<div class="center"><img src="classlibcamera_1_1ipa_1_1ipu3_1_1algorithms_1_1Awb__coll__graph.png" border="0" usemap="#alibcamera_1_1ipa_1_1ipu3_1_1algorithms_1_1Awb_coll__map" alt="Collaboration graph"/></div>
<map name="alibcamera_1_1ipa_1_1ipu3_1_1algorithms_1_1Awb_coll__map" id="alibcamera_1_1ipa_1_1ipu3_1_1algorithms_1_1Awb_coll__map">
<area shape="rect" title="A Grey world white balance correction algorithm." alt="" coords="5,80,156,121"/>
<area shape="rect" href="classlibcamera_1_1ipa_1_1Algorithm.html" title="The base class for all IPA algorithms." alt="" coords="37,5,124,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a09f761dee16ea322dd343d63e234a874"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1ipa_1_1ipu3_1_1algorithms_1_1Awb.html#a09f761dee16ea322dd343d63e234a874">configure</a> (<a class="el" href="structlibcamera_1_1ipa_1_1ipu3_1_1IPAContext.html">IPAContext</a> &amp;context, const IPAConfigInfo &amp;configInfo) override</td></tr>
<tr class="memdesc:a09f761dee16ea322dd343d63e234a874"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configure the <a class="el" href="classlibcamera_1_1ipa_1_1Algorithm.html" title="The base class for all IPA algorithms.">Algorithm</a> given an IPAConfigInfo.  <a href="classlibcamera_1_1ipa_1_1ipu3_1_1algorithms_1_1Awb.html#a09f761dee16ea322dd343d63e234a874">More...</a><br /></td></tr>
<tr class="separator:a09f761dee16ea322dd343d63e234a874"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a525add4516a50bb8e9d82f4ab10da17e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1ipa_1_1ipu3_1_1algorithms_1_1Awb.html#a525add4516a50bb8e9d82f4ab10da17e">prepare</a> (<a class="el" href="structlibcamera_1_1ipa_1_1ipu3_1_1IPAContext.html">IPAContext</a> &amp;context, const uint32_t frame, <a class="el" href="structlibcamera_1_1ipa_1_1ipu3_1_1IPAFrameContext.html">IPAFrameContext</a> &amp;frameContext, ipu3_uapi_params *params) override</td></tr>
<tr class="memdesc:a525add4516a50bb8e9d82f4ab10da17e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill the <em>params</em> buffer with ISP processing parameters for a frame.  <a href="classlibcamera_1_1ipa_1_1ipu3_1_1algorithms_1_1Awb.html#a525add4516a50bb8e9d82f4ab10da17e">More...</a><br /></td></tr>
<tr class="separator:a525add4516a50bb8e9d82f4ab10da17e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85b4f58b1c62a7aeaf5f073698679a39"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1ipa_1_1ipu3_1_1algorithms_1_1Awb.html#a85b4f58b1c62a7aeaf5f073698679a39">process</a> (<a class="el" href="structlibcamera_1_1ipa_1_1ipu3_1_1IPAContext.html">IPAContext</a> &amp;context, const uint32_t frame, <a class="el" href="structlibcamera_1_1ipa_1_1ipu3_1_1IPAFrameContext.html">IPAFrameContext</a> &amp;frameContext, const ipu3_uapi_stats_3a *stats, <a class="el" href="classlibcamera_1_1ControlList.html">ControlList</a> &amp;metadata) override</td></tr>
<tr class="memdesc:a85b4f58b1c62a7aeaf5f073698679a39"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classlibcamera_1_1Process.html" title="Process object.">Process</a> ISP statistics, and run algorithm operations.  <a href="classlibcamera_1_1ipa_1_1ipu3_1_1algorithms_1_1Awb.html#a85b4f58b1c62a7aeaf5f073698679a39">More...</a><br /></td></tr>
<tr class="separator:a85b4f58b1c62a7aeaf5f073698679a39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classlibcamera_1_1ipa_1_1Algorithm"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classlibcamera_1_1ipa_1_1Algorithm')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classlibcamera_1_1ipa_1_1Algorithm.html">libcamera::ipa::Algorithm&lt; _Module &gt;</a></td></tr>
<tr class="memitem:a4baaa3e35c9d5bf452a8937c99f7aedb inherit pub_methods_classlibcamera_1_1ipa_1_1Algorithm"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1ipa_1_1Algorithm.html#a4baaa3e35c9d5bf452a8937c99f7aedb">init</a> ([[maybe_unused]] typename <a class="el" href="classlibcamera_1_1ipa_1_1Module.html#a2a12d05faa4f517f4dfcfa087063fd27">Module::Context</a> &amp;context, [[maybe_unused]] const <a class="el" href="classlibcamera_1_1YamlObject.html">YamlObject</a> &amp;tuningData)</td></tr>
<tr class="memdesc:a4baaa3e35c9d5bf452a8937c99f7aedb inherit pub_methods_classlibcamera_1_1ipa_1_1Algorithm"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the <a class="el" href="classlibcamera_1_1ipa_1_1Algorithm.html" title="The base class for all IPA algorithms.">Algorithm</a> with tuning data.  <a href="classlibcamera_1_1ipa_1_1Algorithm.html#a4baaa3e35c9d5bf452a8937c99f7aedb">More...</a><br /></td></tr>
<tr class="separator:a4baaa3e35c9d5bf452a8937c99f7aedb inherit pub_methods_classlibcamera_1_1ipa_1_1Algorithm"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af69b2793f3c31c578bb11536cfaa652b inherit pub_methods_classlibcamera_1_1ipa_1_1Algorithm"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1ipa_1_1Algorithm.html#af69b2793f3c31c578bb11536cfaa652b">configure</a> ([[maybe_unused]] typename <a class="el" href="classlibcamera_1_1ipa_1_1Module.html#a2a12d05faa4f517f4dfcfa087063fd27">Module::Context</a> &amp;context, [[maybe_unused]] const typename <a class="el" href="classlibcamera_1_1ipa_1_1Module.html#a7c0b7a42c526c07bafeca4018b38b8c9">Module::Config</a> &amp;configInfo)</td></tr>
<tr class="memdesc:af69b2793f3c31c578bb11536cfaa652b inherit pub_methods_classlibcamera_1_1ipa_1_1Algorithm"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configure the <a class="el" href="classlibcamera_1_1ipa_1_1Algorithm.html" title="The base class for all IPA algorithms.">Algorithm</a> given an IPAConfigInfo.  <a href="classlibcamera_1_1ipa_1_1Algorithm.html#af69b2793f3c31c578bb11536cfaa652b">More...</a><br /></td></tr>
<tr class="separator:af69b2793f3c31c578bb11536cfaa652b inherit pub_methods_classlibcamera_1_1ipa_1_1Algorithm"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61b022d6cd1b4423953e9600ca01548e inherit pub_methods_classlibcamera_1_1ipa_1_1Algorithm"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1ipa_1_1Algorithm.html#a61b022d6cd1b4423953e9600ca01548e">queueRequest</a> ([[maybe_unused]] typename <a class="el" href="classlibcamera_1_1ipa_1_1Module.html#a2a12d05faa4f517f4dfcfa087063fd27">Module::Context</a> &amp;context, [[maybe_unused]] const uint32_t frame, [[maybe_unused]] typename <a class="el" href="classlibcamera_1_1ipa_1_1Module.html#a5a1bf7efd7811fb9da8ff311aeef3b1c">Module::FrameContext</a> &amp;frameContext, [[maybe_unused]] const <a class="el" href="classlibcamera_1_1ControlList.html">ControlList</a> &amp;controls)</td></tr>
<tr class="memdesc:a61b022d6cd1b4423953e9600ca01548e inherit pub_methods_classlibcamera_1_1ipa_1_1Algorithm"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provide control values to the algorithm.  <a href="classlibcamera_1_1ipa_1_1Algorithm.html#a61b022d6cd1b4423953e9600ca01548e">More...</a><br /></td></tr>
<tr class="separator:a61b022d6cd1b4423953e9600ca01548e inherit pub_methods_classlibcamera_1_1ipa_1_1Algorithm"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e216e20ff1634a1f56c162397b6d30d inherit pub_methods_classlibcamera_1_1ipa_1_1Algorithm"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1ipa_1_1Algorithm.html#a0e216e20ff1634a1f56c162397b6d30d">prepare</a> ([[maybe_unused]] typename <a class="el" href="classlibcamera_1_1ipa_1_1Module.html#a2a12d05faa4f517f4dfcfa087063fd27">Module::Context</a> &amp;context, [[maybe_unused]] const uint32_t frame, [[maybe_unused]] typename <a class="el" href="classlibcamera_1_1ipa_1_1Module.html#a5a1bf7efd7811fb9da8ff311aeef3b1c">Module::FrameContext</a> &amp;frameContext, [[maybe_unused]] typename <a class="el" href="classlibcamera_1_1ipa_1_1Module.html#a48ee62113eed1c9ad7a001887dc59674">Module::Params</a> *params)</td></tr>
<tr class="memdesc:a0e216e20ff1634a1f56c162397b6d30d inherit pub_methods_classlibcamera_1_1ipa_1_1Algorithm"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill the <em>params</em> buffer with ISP processing parameters for a frame.  <a href="classlibcamera_1_1ipa_1_1Algorithm.html#a0e216e20ff1634a1f56c162397b6d30d">More...</a><br /></td></tr>
<tr class="separator:a0e216e20ff1634a1f56c162397b6d30d inherit pub_methods_classlibcamera_1_1ipa_1_1Algorithm"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea6c5e11591bdc6624b1c76ee4fdd008 inherit pub_methods_classlibcamera_1_1ipa_1_1Algorithm"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1ipa_1_1Algorithm.html#aea6c5e11591bdc6624b1c76ee4fdd008">process</a> ([[maybe_unused]] typename <a class="el" href="classlibcamera_1_1ipa_1_1Module.html#a2a12d05faa4f517f4dfcfa087063fd27">Module::Context</a> &amp;context, [[maybe_unused]] const uint32_t frame, [[maybe_unused]] typename <a class="el" href="classlibcamera_1_1ipa_1_1Module.html#a5a1bf7efd7811fb9da8ff311aeef3b1c">Module::FrameContext</a> &amp;frameContext, [[maybe_unused]] const typename <a class="el" href="classlibcamera_1_1ipa_1_1Module.html#afdcea0695dc0eb1226d66442a5647a41">Module::Stats</a> *stats, [[maybe_unused]] <a class="el" href="classlibcamera_1_1ControlList.html">ControlList</a> &amp;metadata)</td></tr>
<tr class="memdesc:aea6c5e11591bdc6624b1c76ee4fdd008 inherit pub_methods_classlibcamera_1_1ipa_1_1Algorithm"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classlibcamera_1_1Process.html" title="Process object.">Process</a> ISP statistics, and run algorithm operations.  <a href="classlibcamera_1_1ipa_1_1Algorithm.html#aea6c5e11591bdc6624b1c76ee4fdd008">More...</a><br /></td></tr>
<tr class="separator:aea6c5e11591bdc6624b1c76ee4fdd008 inherit pub_methods_classlibcamera_1_1ipa_1_1Algorithm"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_types_classlibcamera_1_1ipa_1_1Algorithm"><td colspan="2" onclick="javascript:toggleInherit('pub_types_classlibcamera_1_1ipa_1_1Algorithm')"><img src="closed.png" alt="-"/>&#160;Public Types inherited from <a class="el" href="classlibcamera_1_1ipa_1_1Algorithm.html">libcamera::ipa::Algorithm&lt; _Module &gt;</a></td></tr>
<tr class="memitem:ac52491716c9cd932770dc1a02d7d9b25 inherit pub_types_classlibcamera_1_1ipa_1_1Algorithm"><td class="memItemLeft" align="right" valign="top"><a id="ac52491716c9cd932770dc1a02d7d9b25"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1ipa_1_1Algorithm.html#ac52491716c9cd932770dc1a02d7d9b25">Module</a> = _Module</td></tr>
<tr class="memdesc:ac52491716c9cd932770dc1a02d7d9b25 inherit pub_types_classlibcamera_1_1ipa_1_1Algorithm"><td class="mdescLeft">&#160;</td><td class="mdescRight">The IPA module type for this class of algorithms. <br /></td></tr>
<tr class="separator:ac52491716c9cd932770dc1a02d7d9b25 inherit pub_types_classlibcamera_1_1ipa_1_1Algorithm"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A Grey world white balance correction algorithm. </p>
<p>The Grey World algorithm assumes that the scene, in average, is neutral grey. Reference: Lam, Edmund &amp; Fung, George. (2008). Automatic White Balancing in Digital Photography. 10.1201/9781420054538.ch10.</p>
<p>The IPU3 generates statistics from the Bayer Down Scaler output into a grid defined in the ipu3_uapi_awb_config_s structure.</p>
<ul>
<li>Cells are defined in Pixels</li>
<li>Zones are defined in Cells <pre class="fragment">                      80 cells
     /───────────── 1280 pixels ───────────\
                      16 zones
      16
    ┌────┬────┬────┬────┬────┬─  ──────┬────┐   \
    │Cell│    │    │    │    │    |    │    │   │
 16 │ px │    │    │    │    │    |    │    │   │
    ├────┼────┼────┼────┼────┼─  ──────┼────┤   │
    │    │    │    │    │    │    |    │    │
    │    │    │    │    │    │    |    │    │   7
    │ ── │ ── │ ── │ ── │ ── │ ──  ── ─┤ ── │ 1 2 4
    │    │    │    │    │    │    |    │    │ 2 0 5

    │    │    │    │    │    │    |    │    │ z p c
    ├────┼────┼────┼────┼────┼─  ──────┼────┤ o i e
    │    │    │    │    │    │    |    │    │ n x l
    │                        │    |    │    │ e e l
    ├───                  ───┼─  ──────┼────┤ s l s
    │                        │    |    │    │   s
    │                        │    |    │    │
    ├───   Zone of Cells  ───┼─  ──────┼────┤   │
    │        (5 x 4)         │    |    │    │   │
    │                        │    |    │    │   │
    ├──                   ───┼─  ──────┼────┤   │
    │                   │    │    |    │    │   │
    │    │    │    │    │    │    |    │    │   │
    └────┴────┴────┴────┴────┴─  ──────┴────┘   /
</pre></li>
</ul>
<p>In each cell, the ImgU computes for each colour component the average of all unsaturated pixels (below a programmable threshold). It also provides the ratio of saturated pixels in the cell.</p>
<p>The AWB algorithm operates on a coarser grid, made by grouping cells from the hardware grid into zones. The number of zones is fixed to <em>kAwbStatsSizeX</em> x <em>kAwbStatsSizeY</em>. For example, a frame of 1280x720 is divided into 80x45 cells of [16x16] pixels and 16x12 zones of [5x4] cells each (<em>kAwbStatsSizeX=16</em> and <em>kAwbStatsSizeY=12</em>). If the number of cells isn't an exact multiple of the number of zones, the right-most and bottom-most cells are ignored. The grid configuration is computed by IPAIPU3::calculateBdsGrid().</p>
<p>Before calculating the gains, the algorithm aggregates the cell averages for each zone in generateAwbStats(). Cells that have a too high ratio of saturated pixels are ignored, and only zones that contain enough non-saturated cells are then used by the algorithm.</p>
<p>The Grey World algorithm will then estimate the red and blue gains to apply, and store the results in the metadata. The green gain is always set to 1. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a09f761dee16ea322dd343d63e234a874"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09f761dee16ea322dd343d63e234a874">&#9670;&nbsp;</a></span>configure()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int libcamera::ipa::ipu3::algorithms::Awb::configure </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structlibcamera_1_1ipa_1_1ipu3_1_1IPAContext.html">IPAContext</a> &amp;&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const IPAConfigInfo &amp;&#160;</td>
          <td class="paramname"><em>configInfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Configure the <a class="el" href="classlibcamera_1_1ipa_1_1Algorithm.html" title="The base class for all IPA algorithms.">Algorithm</a> given an IPAConfigInfo. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">context</td><td>The shared IPA context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">configInfo</td><td>The IPA configuration data, received from the pipeline handler</td></tr>
  </table>
  </dd>
</dl>
<p>Algorithms may implement a configure operation to pre-calculate parameters prior to commencing streaming.</p>
<p>Configuration state may be stored in the <a class="el" href="structlibcamera_1_1ipa_1_1ipu3_1_1IPASessionConfiguration.html" title="Session configuration for the IPA module.">IPASessionConfiguration</a> structure of the <a class="el" href="structlibcamera_1_1ipa_1_1ipu3_1_1IPAContext.html" title="Global IPA context data shared between all algorithms.">IPAContext</a>.</p>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, an error code otherwise </dd></dl>

</div>
</div>
<a id="a525add4516a50bb8e9d82f4ab10da17e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a525add4516a50bb8e9d82f4ab10da17e">&#9670;&nbsp;</a></span>prepare()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libcamera::ipa::ipu3::algorithms::Awb::prepare </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structlibcamera_1_1ipa_1_1ipu3_1_1IPAContext.html">IPAContext</a> &amp;&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlibcamera_1_1ipa_1_1ipu3_1_1IPAFrameContext.html">IPAFrameContext</a> &amp;&#160;</td>
          <td class="paramname"><em>frameContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ipu3_uapi_params *&#160;</td>
          <td class="paramname"><em>params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Fill the <em>params</em> buffer with ISP processing parameters for a frame. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">context</td><td>The shared IPA context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">frame</td><td>The frame context sequence number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">frameContext</td><td>The <a class="el" href="structlibcamera_1_1ipa_1_1FrameContext.html" title="Context for a frame.">FrameContext</a> for this frame </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">params</td><td>The ISP specific parameters</td></tr>
  </table>
  </dd>
</dl>
<p>This function is called for every frame when the camera is running before it is processed by the ISP to prepare the ISP processing parameters for that frame.</p>
<p>Algorithms shall fill in the parameter structure fields appropriately to configure the ISP processing blocks that they are responsible for. This includes setting fields and flags that enable those processing blocks. </p>

</div>
</div>
<a id="a85b4f58b1c62a7aeaf5f073698679a39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85b4f58b1c62a7aeaf5f073698679a39">&#9670;&nbsp;</a></span>process()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libcamera::ipa::ipu3::algorithms::Awb::process </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structlibcamera_1_1ipa_1_1ipu3_1_1IPAContext.html">IPAContext</a> &amp;&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlibcamera_1_1ipa_1_1ipu3_1_1IPAFrameContext.html">IPAFrameContext</a> &amp;&#160;</td>
          <td class="paramname"><em>frameContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ipu3_uapi_stats_3a *&#160;</td>
          <td class="paramname"><em>stats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibcamera_1_1ControlList.html">ControlList</a> &amp;&#160;</td>
          <td class="paramname"><em>metadata</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classlibcamera_1_1Process.html" title="Process object.">Process</a> ISP statistics, and run algorithm operations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">context</td><td>The shared IPA context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">frame</td><td>The frame context sequence number </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">frameContext</td><td>The current frame's context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stats</td><td>The IPA statistics and ISP results </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">metadata</td><td>Metadata for the frame, to be filled by the algorithm</td></tr>
  </table>
  </dd>
</dl>
<p>This function is called while camera is running for every frame processed by the ISP, to process statistics generated from that frame by the ISP. Algorithms shall use this data to run calculations, update their state accordingly, and fill the frame metadata.</p>
<p>Processing shall not take an undue amount of time, and any extended or computationally expensive calculations or operations must be handled asynchronously in a separate thread.</p>
<p>Algorithms can store state in their respective <a class="el" href="structlibcamera_1_1ipa_1_1ipu3_1_1IPAFrameContext.html" title="IPU3-specific FrameContext.">IPAFrameContext</a> structures, and reference state from the <a class="el" href="structlibcamera_1_1ipa_1_1ipu3_1_1IPAFrameContext.html" title="IPU3-specific FrameContext.">IPAFrameContext</a> of other algorithms.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000005">Todo:</a></b></dt><dd>Historical data may be required as part of the processing. Either the previous frame, or the <a class="el" href="structlibcamera_1_1ipa_1_1ipu3_1_1IPAFrameContext.html" title="IPU3-specific FrameContext.">IPAFrameContext</a> state of the frame that generated the statistics for this operation may be required for some advanced algorithms to prevent oscillations or support control loops correctly. Only a single <a class="el" href="structlibcamera_1_1ipa_1_1ipu3_1_1IPAFrameContext.html" title="IPU3-specific FrameContext.">IPAFrameContext</a> is available currently, and so any data stored may represent the results of the previously completed operations.</dd></dl>
<p>Care shall be taken to ensure the ordering of access to the information such that the algorithms use up to date state as required. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/ipa/ipu3/algorithms/<a class="el" href="awb_8h_source.html">awb.h</a></li>
<li>src/ipa/ipu3/algorithms/awb.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
