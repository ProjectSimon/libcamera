<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libcamera: libcamera::ClockRecovery Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">libcamera<span id="projectnumber">&#160;v0.4.0+5314-fc77c53d-nvm</span>
   </div>
   <div id="projectbrief">Supporting cameras in Linux since 2019</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacelibcamera.html">libcamera</a></li><li class="navelem"><a class="el" href="classlibcamera_1_1ClockRecovery.html">ClockRecovery</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classlibcamera_1_1ClockRecovery-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">libcamera::ClockRecovery Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Recover an output clock from an input clock.  
 <a href="classlibcamera_1_1ClockRecovery.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa5e516d42487df3e66afcee02203da04" id="r_aa5e516d42487df3e66afcee02203da04"><td class="memItemLeft" align="right" valign="top"><a id="aa5e516d42487df3e66afcee02203da04" name="aa5e516d42487df3e66afcee02203da04"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ClockRecovery</b> ()</td></tr>
<tr class="memdesc:aa5e516d42487df3e66afcee02203da04"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a <a class="el" href="classlibcamera_1_1ClockRecovery.html" title="Recover an output clock from an input clock.">ClockRecovery</a>. <br /></td></tr>
<tr class="separator:aa5e516d42487df3e66afcee02203da04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4819237917a8af103379b020200e2ada" id="r_a4819237917a8af103379b020200e2ada"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1ClockRecovery.html#a4819237917a8af103379b020200e2ada">configure</a> (unsigned int numSamples=100, unsigned int maxJitter=2000, unsigned int minSamples=10, unsigned int errorThreshold=50000)</td></tr>
<tr class="memdesc:a4819237917a8af103379b020200e2ada"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set configuration parameters.  <br /></td></tr>
<tr class="separator:a4819237917a8af103379b020200e2ada"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac65fe7b47bac12b0a30c71ba9d895aee" id="r_ac65fe7b47bac12b0a30c71ba9d895aee"><td class="memItemLeft" align="right" valign="top"><a id="ac65fe7b47bac12b0a30c71ba9d895aee" name="ac65fe7b47bac12b0a30c71ba9d895aee"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>reset</b> ()</td></tr>
<tr class="memdesc:ac65fe7b47bac12b0a30c71ba9d895aee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the clock recovery model and start again from scratch. <br /></td></tr>
<tr class="separator:ac65fe7b47bac12b0a30c71ba9d895aee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace9d9f9bdac6d9d0e06d9ad75ec9d689" id="r_ace9d9f9bdac6d9d0e06d9ad75ec9d689"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1ClockRecovery.html#ace9d9f9bdac6d9d0e06d9ad75ec9d689">addSample</a> ()</td></tr>
<tr class="memdesc:ace9d9f9bdac6d9d0e06d9ad75ec9d689"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a sample point to the clock recovery model, for recovering a wall clock value from the internal system time since boot.  <br /></td></tr>
<tr class="separator:ace9d9f9bdac6d9d0e06d9ad75ec9d689"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f8fc7a465505b412c61a642506f48db" id="r_a3f8fc7a465505b412c61a642506f48db"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1ClockRecovery.html#a3f8fc7a465505b412c61a642506f48db">addSample</a> (uint64_t input, uint64_t output)</td></tr>
<tr class="memdesc:a3f8fc7a465505b412c61a642506f48db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a sample point to the clock recovery model, specifying the exact input and output clock values.  <br /></td></tr>
<tr class="separator:a3f8fc7a465505b412c61a642506f48db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a837e6cd0dacfc917247f8116d92dd21c" id="r_a837e6cd0dacfc917247f8116d92dd21c"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibcamera_1_1ClockRecovery.html#a837e6cd0dacfc917247f8116d92dd21c">getOutput</a> (uint64_t input)</td></tr>
<tr class="memdesc:a837e6cd0dacfc917247f8116d92dd21c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the output clock value according to the model from an input clock value.  <br /></td></tr>
<tr class="separator:a837e6cd0dacfc917247f8116d92dd21c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Recover an output clock from an input clock. </p>
<p>The <a class="el" href="classlibcamera_1_1ClockRecovery.html" title="Recover an output clock from an input clock.">ClockRecovery</a> class derives an output clock from an input clock, modelling the output clock as being linearly related to the input clock. For example, we may use it to derive wall clock timestamps from timestamps measured by the internal system clock which counts local time since boot.</p>
<p>When pairs of corresponding input and output timestamps are available, they should be submitted to the model with <a class="el" href="classlibcamera_1_1ClockRecovery.html#ace9d9f9bdac6d9d0e06d9ad75ec9d689" title="Add a sample point to the clock recovery model, for recovering a wall clock value from the internal s...">addSample()</a>. The model will update, and output clock values for known input clock values can be obtained using <a class="el" href="classlibcamera_1_1ClockRecovery.html#a837e6cd0dacfc917247f8116d92dd21c" title="Calculate the output clock value according to the model from an input clock value.">getOutput()</a>.</p>
<p>As a convenience, if the input clock is indeed the time since boot, and the output clock represents a real wallclock time, then <a class="el" href="classlibcamera_1_1ClockRecovery.html#ace9d9f9bdac6d9d0e06d9ad75ec9d689" title="Add a sample point to the clock recovery model, for recovering a wall clock value from the internal s...">addSample()</a> can be called with no arguments, and a pair of timestamps will be captured at that moment.</p>
<p>The <a class="el" href="classlibcamera_1_1ClockRecovery.html#a4819237917a8af103379b020200e2ada" title="Set configuration parameters.">configure()</a> function accepts some configuration parameters to control the linear fitting process. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="ace9d9f9bdac6d9d0e06d9ad75ec9d689" name="ace9d9f9bdac6d9d0e06d9ad75ec9d689"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace9d9f9bdac6d9d0e06d9ad75ec9d689">&#9670;&#160;</a></span>addSample() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libcamera::ClockRecovery::addSample </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a sample point to the clock recovery model, for recovering a wall clock value from the internal system time since boot. </p>
<p>This is a convenience function to make it easy to derive a wall clock value (using the Linux CLOCK_REALTIME) from the time since the system started (measured by CLOCK_BOOTTIME). </p>

</div>
</div>
<a id="a3f8fc7a465505b412c61a642506f48db" name="a3f8fc7a465505b412c61a642506f48db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f8fc7a465505b412c61a642506f48db">&#9670;&#160;</a></span>addSample() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libcamera::ClockRecovery::addSample </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a sample point to the clock recovery model, specifying the exact input and output clock values. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">input</td><td>The input clock value </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">output</td><td>The value of the output clock at the same moment, as far as possible, that the input clock was sampled</td></tr>
  </table>
  </dd>
</dl>
<p>This function should be used for corresponding clocks other than the Linux BOOTTIME and REALTIME clocks. </p>

</div>
</div>
<a id="a4819237917a8af103379b020200e2ada" name="a4819237917a8af103379b020200e2ada"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4819237917a8af103379b020200e2ada">&#9670;&#160;</a></span>configure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libcamera::ClockRecovery::configure </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>numSamples</em> = <code>100</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>maxJitter</em> = <code>2000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>minSamples</em> = <code>10</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>errorThreshold</em> = <code>50000</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set configuration parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">numSamples</td><td>The approximate duration for which the state of the model is persistent </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxJitter</td><td>New output samples are clamped to no more than this amount of jitter, to prevent sudden swings from having a large effect </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">minSamples</td><td>The fitted clock model is not used to generate outputs until this many samples have been received </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">errorThreshold</td><td>If the accumulated differences between input and output clocks reaches this amount over a few frames, the model is reset </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a837e6cd0dacfc917247f8116d92dd21c" name="a837e6cd0dacfc917247f8116d92dd21c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a837e6cd0dacfc917247f8116d92dd21c">&#9670;&#160;</a></span>getOutput()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t libcamera::ClockRecovery::getOutput </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>input</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the output clock value according to the model from an input clock value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">input</td><td>The input clock value</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Output clock value </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>include/libcamera/internal/<a class="el" href="clock__recovery_8h_source.html">clock_recovery.h</a></li>
<li>src/libcamera/<b>clock_recovery.cpp</b></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
